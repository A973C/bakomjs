/*
 * @preserve
 * bakom.js 1.1
 * http://erikportin.com/bakomjs
 *
 * Copyright 2013 Erik Portin
 * Released under the MIT license
 * https://github.com/erikportin/bakomjs/blob/master/LICENCE.md
 */
window.Bakom=function(e){var t=this,n="",o=false,l=false,r={},i,s,a={};t.defaults={backgroundSelector:"body",textSelector:"",styleClass:"",dy:"",backgroundClipSupportOnly:true};var u=function(e){var o=function(){var e=function(){var e=document.defaultView.getComputedStyle(r.element,null).getPropertyValue("background-image"),o="",l=[],i=document.defaultView.getComputedStyle(r.element,null).getPropertyValue("background-attachment");if(!t.defaults.backgroundClipSupportOnly){var s=document.defaultView.getComputedStyle(r.element,null).getPropertyValue("background-repeat");if(s!=="no-repeat"){console.warn('BAKOM.JS: background-repeat is set to "'+s+'" which can cause issues for browsers not supporting Background Clip. Set property to "no-repeat" to avoid this warning.')}if(i!=="scroll"){console.warn('BAKOM.JS: background-attachment is set to "'+i+'" which is not supported. Set property to "scroll" to avoid this warning.')}}if(e&&e!=="none"){o=document.defaultView.getComputedStyle(r.element,null).getPropertyValue("background-position").split(" ");l=document.defaultView.getComputedStyle(r.element,null).getPropertyValue("background-size").split(" ");e=e.slice(e.indexOf("url(")+4,e.lastIndexOf(")"));r.pos=n();if(i==="fixed"){r.pos.left=0;r.pos.top=0}r.prop={src:e,x:parseInt(o[0],10),y:parseInt(o[1],10),size:{width:parseInt(l[0],10),height:parseInt(l[1],10)}};return true}else{console.error("BAKOM.JS: Unable to find a background image for "+r.element);return false}},n=function(){return{bottom:r.element.getBoundingClientRect().bottom,height:r.element.getBoundingClientRect().height,left:r.element.getBoundingClientRect().left,right:r.element.getBoundingClientRect().right,top:r.element.getBoundingClientRect().top,width:r.element.getBoundingClientRect().width}};if(!t.defaults.backgroundSelector){console.error("BAKOM.JS: Background element selector not set");return false}r.element=document.querySelectorAll(t.defaults.backgroundSelector)[0];if(r.element){return e()}else{console.error("BAKOM.JS: Unable to find background element "+t.defaults.backgroundSelector);return false}},l=function(){if(!t.defaults.textSelector){console.error("BAKOM.JS: Text element selector not set"+t.defaults.textSelector);return false}var e=document.querySelectorAll(t.defaults.textSelector)[0];if(e){i={element:e,pos:e.getBoundingClientRect()};if(!t.defaults.styleClass)t.defaults.styleClass=e.className.slice(0);return true}else{console.error("BAKOM.JS: Unable to find text element "+t.defaults.textSelector);return false}};for(var s in e){if(t.defaults.hasOwnProperty(s)&&e.hasOwnProperty(s)){t.defaults[s]=e[s]}}var a=0;while(document.getElementById("bakom-cp-"+a)){a++}n="bakom-cp-"+a;return o()&&l()},c=function(){var e=function(e){var t=document.createElement("div");t.innerHTML=e;return t.firstChild},l=function(){var t='<svg width="'+i.pos.width+'" height="'+i.pos.height+'">'+"<image "+"xlink:href="+r.prop.src+'width="'+r.prop.size.width+'"'+'height="'+r.prop.size.height+'"'+'clip-path="url(#'+n+')"'+'x="'+(r.pos.left-i.pos.left+r.prop.x)+'"'+'y="'+(r.pos.top-i.pos.top+r.prop.y)+'"'+">"+"</image>"+"</svg>";s=i.element.innerHTML;i.element.innerHTML="";a.image=e(t);i.element.appendChild(a.image)},u=function(){var o='<svg style="position: absolute; top: 0; left:0; z-index: -1;">'+"<defs>"+'<clipPath id="'+n+'">'+'<text text-anchor="start" x="0" dy="'+t.defaults.dy+'" class="'+t.defaults.styleClass+'">'+i.element.innerHTML+"</text>"+"</clipPath>"+"</defs>"+"</svg>";a.clipPath=e(o);document.body.appendChild(a.clipPath)};u();l();o=true},d=function(){i.style={};i.style.backgroundPosition=i.element.style.backgroundPosition;i.style.backgroundImage=i.element.style.backgroundImage;i.style.webkitBackgroundClip=i.element.style.webkitBackgroundClip;i.style.backgroundClip=i.element.style.backgroundClip;i.style.color=i.element.style.color;i.element.style.backgroundPosition=r.pos.left-i.pos.left+r.prop.x+"px "+(r.pos.top-i.pos.top+r.prop.y)+"px";i.element.style.backgroundSize=r.prop.size.width+"px "+r.prop.size.height+"px";i.element.style.backgroundImage="url("+r.prop.src+")";i.element.style.webkitBackgroundClip="text";i.element.style.backgroundClip="text";i.element.style.color="rgba(0, 0, 0, 0)";o=true},p=function(){for(var e in i.style){i.element.style[e]=i.style[e]}},g=function(){for(var e in a){a[e].parentNode.removeChild(a[e])}},f=function(){i.element.innerHTML=s},m=function(e){if(u(e)){if(l)d();else if(!t.defaults.backgroundClipSupportOnly)c()}else{console.error("BAKOM.JS: Something went wrong in the setup. Either the background or text element selector wasn't set or one of the element wasn't found")}},y=function(){if(o){if(l)p();else{g();f()}}};var h=document.createElement("x-test"),l=typeof h.style.webkitBackgroundClip!=="undefined"&&(h.style.webkitBackgroundClip="text",h.style.webkitBackgroundClip==="text")||typeof h.style.backgroundClip!=="undefined"&&(h.style.backgroundClip="text",h.style.backgroundClip==="text");if(e.backgroundClipSupportOnly&&l||!e.backgroundClipSupportOnly)m(e);t.reset=function(){y()};t.redraw=function(e){if(o){y();m(e)}}};
//# sourceMappingURL=bakom.sourcemap